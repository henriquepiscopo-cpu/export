Sub CopiarUltimaLinhaVolume_Para_Deb_CRICRA()

    Dim wsOrigem As Worksheet
    Dim wsDestino As Worksheet
    Dim lastRowOrigem As Long
    Dim lastRowDestino As Long
    Dim c As Long

    ' Define as abas
    Set wsOrigem = ThisWorkbook.Worksheets("Volume")
    Set wsDestino = ThisWorkbook.Worksheets("Deb, CRICRA FII Fiagro (Mensal)")

    ' Última linha com dados na coluna B da aba Volume
    lastRowOrigem = wsOrigem.Cells(wsOrigem.Rows.Count, "B").End(xlUp).Row

    ' Próxima linha vazia na coluna B da aba Destino
    lastRowDestino = wsDestino.Cells(wsDestino.Rows.Count, "B").End(xlUp).Row + 1

    ' Copia B:P da última linha da aba Volume
    wsOrigem.Range("B" & lastRowOrigem & ":P" & lastRowOrigem).Copy

    ' Cola apenas valores em B:P da linha nova
    wsDestino.Range("B" & lastRowDestino).PasteSpecial Paste:=xlPasteValues

    Application.CutCopyMode = False

    ' ===== TRATAMENTOS =====

    ' Coluna B → forçar como data (mês/ano) no formato "nov-25"
    With wsDestino.Cells(lastRowDestino, "B")
        If IsDate(.Value) Then
            .Value = DateSerial(Year(CDate(.Value)), Month(CDate(.Value)), 1)
            .NumberFormat = "mmm-yy"
        End If
    End With

    ' Colunas C até P → dividir por 1.000.000.000
    For c = wsDestino.Range("C1").Column To wsDestino.Range("P1").Column
        With wsDestino.Cells(lastRowDestino, c)
            If IsNumeric(.Value) And Not IsEmpty(.Value) Then
                .Value = .Value / 1000000000#
            End If
        End With
    Next c

    MsgBox "Dados copiados e tratados com sucesso!", vbInformation

End Sub


