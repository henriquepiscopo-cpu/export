Option Explicit

Sub Copiar_ANBIMA_Para_InputNTNB()

    Dim wsOrigem As Worksheet
    Dim wsDestino As Worksheet
    Dim rngOrigem As Range
    Dim rngDestino As Range
    Dim lastRowDest As Long

    Set wsOrigem = ThisWorkbook.Worksheets("ANBIMA_DADOS")
    Set wsDestino = ThisWorkbook.Worksheets("input ntnb")

    ' Origem: A3:AI30
    Set rngOrigem = wsOrigem.Range("A3:AI30")

    ' Destino: começa em B48 com o mesmo tamanho
    Set rngDestino = wsDestino.Range("B48").Resize(rngOrigem.Rows.Count, rngOrigem.Columns.Count)
    lastRowDest = 48 + rngOrigem.Rows.Count - 1

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    On Error GoTo Fail

    ' 1) Cola valores
    rngDestino.Value = rngOrigem.Value

    ' 2) Limpa formatação antiga no destino
    rngDestino.ClearFormats

    ' 3) Formata tudo como número (base)
    rngDestino.NumberFormat = "#,##0.00"

    ' 4) Colunas que devem ser DATA
    wsDestino.Range("C48:C" & lastRowDest).NumberFormat = "dd/mm/yyyy"
    wsDestino.Range("D48:D" & lastRowDest).NumberFormat = "dd/mm/yyyy"
    wsDestino.Range("O48:O" & lastRowDest).NumberFormat = "dd/mm/yyyy"
    wsDestino.Range("P48:P" & lastRowDest).NumberFormat = "dd/mm/yyyy"
    wsDestino.Range("AA48:AA" & lastRowDest).NumberFormat = "dd/mm/yyyy"
    wsDestino.Range("AB48:AB" & lastRowDest).NumberFormat = "dd/mm/yyyy"

CleanExit:
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    Exit Sub

Fail:
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    MsgBox "Erro ao copiar/formatar dados ANBIMA: " & Err.Number & " - " & Err.Description, vbExclamation
End Sub
