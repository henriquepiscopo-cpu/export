Option Explicit

Sub Shift_3_Posicoes_InputNTNB()

    Const ABA As String = "input ntnb"
    Const BACKUP_ABA As String = "_backup_ntnb"

    Const POS1 As String = "B48:AK65"
    Const POS2 As String = "B27:AK44"
    Const POS3 As String = "B5:AK22"

    Dim ws As Worksheet, wb As Worksheet
    Dim rng1 As Range, rng2 As Range, rng3 As Range
    Dim bkp As Worksheet

    Set wb = ThisWorkbook
    Set ws = wb.Worksheets(ABA)
    Set bkp = wb.Worksheets(BACKUP_ABA)

    Set rng1 = ws.Range(POS1)
    Set rng2 = ws.Range(POS2)
    Set rng3 = ws.Range(POS3)

    Application.ScreenUpdating = False

    ' ===== BACKUP (antes do shift) =====
    bkp.Range(POS1).Value = rng1.Value
    bkp.Range(POS2).Value = rng2.Value
    bkp.Range(POS3).Value = rng3.Value

    ' ===== SHIFT =====
    rng3.Value = rng2.Value
    rng2.Value = rng1.Value
    rng1.ClearContents

    Application.ScreenUpdating = True

    MsgBox "Atualização concluída. Use o botão DESFAZER se necessário.", vbInformation

End Sub
